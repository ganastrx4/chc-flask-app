<!DOCTYPE html>
<html>
<head>
  <title>CharlyCoin Login</title>
  <script src="https://cdn.worldcoin.org/idkit.js"></script>
</head>
<body>
  <h1>Iniciar sesión con World ID</h1>

  <div id="world-id"></div>

  <script>
  function generarSignalUnico() {
    const timestamp = Date.now();
    const aleatorio = Math.random().toString(36).substring(2, 10);
    return `wld-login-${timestamp}-${aleatorio}`;
  }

  window.addEventListener('DOMContentLoaded', function () {
    const signalDinamico = generarSignalUnico();

    new IDKitWidget({
      app_id: "app_7686f9027d3e3c0b53d987a3caf1e111", // Tu app_id
      action: "login",
      signal: signalDinamico,
      onSuccess: (response) => {
        console.log("✅ Verificado con signal:", signalDinamico, response);
        alert("✅ Verificación exitosa con World ID");
      },
      onError: (error) => {
        console.error("❌ Error al verificar:", error);
        alert("❌ Ocurrió un error con World ID");
      },
    }).mount("#world-id-button");
  });
</script>

</body>
</html>
