<div class="container">
    <h1 class="mb-3">üìä Estad√≠sticas de WLD</h1>

    <h2 class="mt-3">üí∞ Precio en Tiempo Real</h2>
    <p>Precio actual: <span id="price">Cargando...</span> USDT</p>

    <h2 class="mt-4">üìâ Gr√°fico de Movimientos Recientes</h2>
    <p class="loading" id="loadingMsg">Cargando datos...</p>

    <div class="mb-3">
        <button class="btn btn-primary btn-timeframe" onclick="fetchChartData('1m')">1 Minuto</button>
        <button class="btn btn-primary btn-timeframe" onclick="fetchChartData('5m')">5 Minutos</button>
        <button class="btn btn-primary btn-timeframe" onclick="fetchChartData('15m')">15 Minutos</button>
        <button class="btn btn-primary btn-timeframe" onclick="fetchChartData('1h')">1 Hora</button>
        <button class="btn btn-primary btn-timeframe" onclick="fetchChartData('4h')">4 Horas</button>
    </div>

    <canvas id="priceChart"></canvas>
</div>

<div class="link-container">
    <p>¬°Obt√©n NUEVO TOKEN WDD GRATIS!</p>
    <div class="d-flex justify-content-center align-items-center mt-3">
        <a href="#" onclick="loadPage('wdd.html')" class="btn btn-warning btn-lg">Ver la p√°gina de WDD</a>
    </div>
</div>

<div class="d-flex justify-content-center align-items-center mt-4">
    <a href="#" onclick="loadPage('buscador.html')" class="btn btn-warning btn-lg">üîç Ver precios de CRIPTOMONEDAS</a>
</div>

<div class="d-flex justify-content-center align-items-center mt-4">
    <a href="#" onclick="loadPage('reclamarchun.html')" class="btn btn-warning btn-lg">üåê Reclamar CHUN</a>
</div>

<script>
    let priceChart;
    let timeframe = "1m";

    function fetchPrice() {
        $.getJSON("https://api.binance.com/api/v3/ticker/price?symbol=WLDUSDT", function(data) {
            let price = parseFloat(data.price).toFixed(4);
            $("#price").text(price);
        });
    }

    function fetchChartData(tf) {
        timeframe = tf;
        $("#loadingMsg").text("Cargando datos...");

        $.getJSON(`https://api.binance.com/api/v3/klines?symbol=WLDUSDT&interval=${timeframe}&limit=10`, function(data) {
            let labels = [];
            let prices = [];

            data.forEach(candle => {
                let time = new Date(candle[0]).toLocaleTimeString();
                let closePrice = parseFloat(candle[4]).toFixed(4);
                labels.push(time);
                prices.push(closePrice);
            });

            updateChart(labels, prices);
            $("#loadingMsg").text("");
        });
    }

    function updateChart(labels, prices) {
        if (!priceChart) {
            let ctx = document.getElementById('priceChart').getContext('2d');
            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: `Precio de WLD/USDT (${timeframe})`,
                        data: prices,
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.2)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Tiempo'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Precio (USDT)'
                            },
                            beginAtZero: false
                        }
                    }
                }
            });
        } else {
            priceChart.data.labels = labels;
            priceChart.data.datasets[0].data = prices;
            priceChart.data.datasets[0].label = `Precio de WLD/USDT (${timeframe})`;
            priceChart.update();
        }
    }

    setInterval(fetchPrice, 5000);
    fetchPrice();
    fetchChartData("1m");
</script>
